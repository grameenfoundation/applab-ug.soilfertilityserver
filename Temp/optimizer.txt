Sub Optimize_Solver()
'
' Optimize_Solver Macro
'

' Unprotect the spreadsheet if columns
    ActiveSheet.Unprotect "52Fre"
    
' Reset all fertilizer application levels to 0
    Range("$O32:$S37") = 0
    Range("$V$89").Select
    
' Clears all previous objective functions or constraints from solver dialog box
    SolverReset
    
' Maximize $V$76 (Net Returns) by changing $O$32:$S$37 (Fertilizer Application Amounts and Area Planted)
    SolverOk SetCell:="$V$76", MaxMinVal:=1, ValueOf:="0", ByChange:="$O$32:$S$37"
    
' Constraint $O$32:$S$37(Fertilizer Application Amount) >= $O$18:$S$23 (Fertilizer Min Application Rate)
    SolverAdd CellRef:="$O$32:$S$37", Relation:=3, FormulaText:="$O$18:$S$23"
    
' Constraint $O$32:$S$37(Fertilizer Application Amount) <= $T$18:$X$23 (Fertilizer Max Application Rate)
    SolverAdd CellRef:="$O$32:$S$37", Relation:=1, FormulaText:="$T$18:$X$23"
    
' Constraint $AB$32:$AD$37(Fertilizer Total) <= $Y$18:$AA$23 (Fertilizer Total Maxes)
    SolverAdd CellRef:="$AB$32:$AD$37", Relation:=1, FormulaText:="$Y$18:$AA$23"
    
' Constraint $T$55(Fertilizer Cost/Crop) <= $U$55 (Budget Constraint)
    SolverAdd CellRef:="$T$52", Relation:=1, FormulaText:="$U$52"

' Cancels the solver solution window from appearing
    SolverSolve userFinish:=True
       
' Reposition the active window
    Range("B41").Select
    ActiveWindow.SmallScroll Down:=10
    
' If statement to password protect the spreadsheet if columns L thru AI are not hidden
    If Columns("L:AI").Hidden = True Then
    ActiveSheet.Protect Password:="52Fre"
    End If


    
End Sub


